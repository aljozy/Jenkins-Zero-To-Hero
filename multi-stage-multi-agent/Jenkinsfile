pipeline {
  agent none
  stages {
stage('Checkout') {
            steps {
                // Checkout code from the repository
                checkout scm
            }
        }

    
    stage('Back-end') {
      agent {
        docker { image 'maven:3.8.1-adoptopenjdk-11' }
      }

        stage('List Files') {
            steps {
                // List files in the workspace to verify HelloWorld.java exists
                sh 'ls -l'
            }
          
        }
 stage('build'){
      steps {
        sh 'mvn --version'
      catchError(buildResult: 'SUCCESS', stageResult: 'FAILURE') {
                    sh '''
                        javac ~/multi-stage-multi-agent/HelloWorld.java
                        java ~/multi-stage-multi-agent/HelloWorld
                    '''
                }
                echo 'Back-end stage completed, moving to Front-end...'
            } 
 }
    }
    stage('Front-end') {
      agent {
        docker { image 'node:16-alpine' }
      }
      steps {
        sh 'node --version'
      }
    }
  }
}
